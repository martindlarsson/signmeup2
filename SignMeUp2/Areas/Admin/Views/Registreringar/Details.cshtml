@model SignMeUp2.ViewModels.RegistreringVM

@{
    ViewBag.Title = "Registrering";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

@{Html.RenderPartial("_formularOversikt");}

@{Html.RenderPartial("_Message", null);}

<div class="row">
    <h3>Registrering</h3>
</div>

@using (Html.BeginForm())
{

    <div class="col-md-12">

        <div class="row">
            <div class="col-lg-2">Att betala</div>
            <div class="col-lg-10">@Model.AttBetala</div>
        </div>

        <div class="row">
            <div class="col-lg-2">Registreringstid</div>
            <div class="col-lg-10">@Model.Registreringstid</div>
        </div>

        <div class="row">
            <div class="col-lg-2">Rabatt</div>
            <div class="col-lg-10">@Model.Rabatt</div>
        </div>

        <div class="row">
            <div class="col-lg-2">Rabattkod</div>
            <div class="col-lg-10">@Model.Rabattkod</div>
        </div>

        <div class="row">
            <div class="col-lg-2">Förseningsavgift</div>
            <div class="col-lg-10">@Model.Forseningsavgift</div>
        </div>

        @if (Model.Invoice != null)
        {
            <div class="row">
                <div class="col-lg-2">Fakturaadress</div>
                <div class="col-lg-4">@Html.ActionLink("Länk till fakturaadressen", "Details", "Invoice", new { id = Model.Invoice.Id }, null)</div>
            </div>
        }

        <div class="row">
            <div class="col-lg-2">Kommentar</div>
            <div class="col-lg-10">@Model.Kommentar</div>
        </div>

        @foreach (var steg in Model.Formular.Steg)
        {
            <h3>@steg.Namn</h3>

            foreach (var falt in steg.FaltLista)
            {
                var svar = Model.Svar.FirstOrDefault(s => s.FaltId == falt.FaltId);

                <div class="row">
                    @if (svar != null) {
                    var avgift = svar.Avgift != 0 ? svar.Avgift.ToString() : "";
                    <div class="col-lg-2">@falt.Namn</div>
                    <div class="col-lg-4">@svar.Varde</div>
                    <div class="col-lg-2">@avgift</div>
                    }
                </div>
            }
        }
    </div>

    
    <div class="row top-buffer">
        <div class="col-lg-2">
            <input type="submit" value="Skicka bekräftelse" name="sendReg" class="btn btn-success pull-right" />
        </div>

        @if (Model.Invoice != null)
        {
            <div class="col-lg-2">
                <input type="submit" value="Skicka faktura" name="sendInvoice" class="btn btn-success pull-right" />
            </div>
        }
    </div>

    <div class="row top-buffer">
        <div class="col-lg-2">
            @Html.ActionLink("Radera", "Delete", new { id = Model.Id }, new { @class = "btn btn-danger", @onclick = "return confirm('Är du säker på att du vill radera denna registrering?');" })
        </div>

        <div class="col-lg-2">
            @Html.ActionLink("Redigera", "Edit", new { id = Model.Id }, new { @class = "btn btn-primary" })
        </div>
    </div>
}
